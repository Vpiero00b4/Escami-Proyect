<div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="cartOffcanvasLabel">ðŸ›’ Carrito</h5>
    <button type="button" class="btn-close" (click)="toggleCart(false)"></button>
  </div>

  <div class="offcanvas-body">
    <div *ngIf="items.length === 0" class="text-center py-12">
      <div class="text-4xl mb-3">ðŸ›’</div>
      <h5 class="text-gray-700 mb-2">Tu carrito estÃ¡ vacÃ­o</h5>
      <p class="text-gray-500">Agrega productos desde el catÃ¡logo</p>
    </div>

    <div *ngIf="items.length > 0" class="space-y-4">
      <div *ngFor="let item of items" class="card shadow-sm border-0">
        <div class="card-body d-flex justify-content-between align-items-center p-3">
          <div class="flex-grow-1">
            <h6 class="card-title mb-1">{{ item.titulo }}</h6>
            <small class="text-muted">{{ item.autor || 'Autor no disponible' }}</small>
            <p class="text-sm text-gray-500 mb-1">{{ item.descripcion | slice:0:50 }}{{ item.descripcion.length > 50 ? '...' : '' }}</p>

            <div class="d-flex items-center gap-2 mt-1">
              <label class="form-label m-0 small">Cantidad</label>
              <input type="number" class="form-control form-control-sm w-20"
                     min="1" [max]="item.stock"
                     [value]="item.cantidad"
                     (change)="onQtyChange(item.idLibro, $event)" />
              <small class="text-muted">Stock: {{ item.stock }}</small>
            </div>
          </div>

          <div class="text-end flex-shrink-0">
            <div class="text-lg font-bold text-green-600 mb-2">${{ item.precio * item.cantidad }}</div>
            <button class="btn btn-sm btn-outline-danger w-full" (click)="removerItem(item.idLibro)">Eliminar</button>
          </div>
        </div>
      </div>

      <div class="border-t pt-3 flex justify-between items-center font-bold text-lg">
        <span>Total:</span>
        <span>${{ total }}</span>
      </div>

      <div class="mt-3">
        <button class="btn btn-primary w-100 py-2" (click)="confirmarCompra()">Confirmar compra</button>
      </div>
    </div>
  </div>
</div>
